---
title: "PortSwigger Academy XSS Apprentice Level Labs"
date: 2025-08-01 00:00:00 +0800
categories: [Web, PortSwigger]
tags: [xss, portswigger, web-security, cross-site-scripting, writeup]
---


## Introduction

Cross-Site Scripting (XSS) is one of the most common and impactful vulnerabilities in web applications. It arises when an application includes untrusted data in its HTML content without proper validation or escaping. This allows attackers to inject malicious scripts into web pages viewed by other users.

There are several types of XSS vulnerabilities, including **reflected**, **stored**, and **DOM-based** XSS. Each type exploits different weaknesses in how user input is handled or rendered. An attacker can leverage XSS to steal session cookies, deface websites, deliver malware, or perform actions on behalf of authenticated users.

PortSwiggerâ€™s XSS Apprentice labs are designed to help learners develop a deeper understanding of how XSS works in various contexts and how to exploit it effectively. In this writeup, I will walk through each lab in the XSS Apprentice series, explaining the vulnerabilities and how to exploit them.

> For more details on Cross-Site Scripting, refer to the official [PortSwigger XSS documentation](https://portswigger.net/web-security/cross-site-scripting).



Lab 1: Reflected XSS into HTML context with nothing encoded
Question: This lab contains a simple reflected cross-site scripting vulnerability in the search functionality. To solve the lab, perform a cross-site scripting attack that calls the alert function.

Solution:
After visiting the main page, a search bar will be shown as in the following screenshot:
![search bar](/assets/img/2025-08-01.png)

At first, let us try to just search the keyword "test" and find out how the user controlled input gets processed:
![place where the input gets reflected](/assets/img/2025-08-01_18-21.png)

We can observe that it gets placed between h1 tag. 

Now, lets just try to send an html tag ,for example, `<div>test</div>`:
![sending an input containing html tags](/assets/img/2025-08-01_18-24.png)

It is to observe that the input does not get validated or sanitized as the user can add a new html tag.

So sending the payload `<script>alert(1)</script>` should also add additional in-line script tag and execute alert function successfully:
![proof of concept](/assets/img/2025-08-01_18-28.png)


Lab 2: Stored XSS into HTML context with nothing encoded

Question: This lab contains a stored cross-site scripting vulnerability in the comment functionality.
To solve this lab, submit a comment that calls the alert function when the blog post is viewed.

Solution:
In the main page, visit any post by clicking "View post" button.
After that, you will be able to see the section where the user can post a comment like in the screenshot below:
![comment section](/assets/img/2025-08-01_18-46.png)

In this case, I would just try to input the basic payload which is `<script>alert(1)</script>` and see how the input gets reflected after it was sotred:
![comment section](/assets/img/2025-08-01_18-48.png)
After cliking the button "Post comment", you will see that the lab is solved. To verify that it works, just visit the post where you added the comment. Then you will observe that the page firstly shows the alert. 

As you can see the comment section was vunlerable to XSS and the input was not validated at all:
![comment section](/assets/img/2025-08-01_18-52.png)

Lab 3: DOM XSS in document.write sink using source location.search

Question:
This lab contains a DOM-based cross-site scripting vulnerability in the search query tracking functionality. It uses the JavaScript document.write function, which writes data out to the page. The document.write function is called with data from location.search, which you can control using the website URL.

To solve this lab, perform a cross-site scripting attack that calls the alert function.

TBD

